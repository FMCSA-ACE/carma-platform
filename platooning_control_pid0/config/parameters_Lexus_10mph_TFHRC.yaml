#-----Heading PID constants
# deadband where control error is ignored, rad
pid_h_deadband: 0.0

# breakpoint where p value changes from kp1 to kp2, rad
pid_h_slope_break: 0.070 #0.07 rad = 4 deg

# first proportional gain, rad/rad
pid_h_kp1: -0.4 #last = -0.4; best -0.3 to -0.5

# second proportional gain, rad/rad
pid_h_kp2: -0.4

# integral gain, rad/rad
pid_h_ki: -0.0080 #last -0.008

# derivative gain, rad/rad
pid_h_kd: 0.014 #last=0.014

# min value allowed for integral term
pid_h_integral_min: -1.0 #initial guess NOT TUNED!

# max value allowed for integral term
pid_h_integral_max: 1.0 #initial guess NOT TUNED!


#-----CTE PID constants
# deadband where control error is ignored, m
pid_c_deadband: 0.0 #initial guess NOT TUNED!

# breakpoint where p value changes from kp1 to kp2, m
pid_c_slope_break: 10.0 #initial guess NOT TUNED!

# first proportional gain, rad/m
pid_c_kp1: 0.020 #last=0.020 #0.04 good at 15mph; 0.015 good at 25

# second proportional gain, rad/m
pid_c_kp2: 0.04 #last=0.04

# integral gain, rad/m
pid_c_ki: 0.0130 #last=0.013 #0.0025 works well at 25 mph

# derivative gain, rad/m
pid_c_kd: 0.030 #last=0.03

# min value allowed for integral term
pid_c_integral_min: -8.0 #10 good at 30 mph, 50 too large

# max value allowed for integral term
pid_c_integral_max: 8.0 #1.0 good for 15 mph


#-----Common PID constants
# Fraction of weight applied to heading PID instead of CTE PID.
# Value must be in [0, 1], where 0 only uses CTE and 1 only uses heading
gamma_h: 0.8 #last=0.8

# Amount of future time projected onto trajectory to find the target curvature, sec
# (must be >= 0)
lookahead_time: 0.5 #1.0 reasonably good for Suntrax curves @30 mph

# expected time elapsed between calls to PID controllers, s
# This value needs to be 1/control_timer frequency that is set at bottom of initialize()
time_step: 0.033333

# max absolute value of steering angle output, rad
# TODO this needs to come from global vehicle config
max_steering_angle: 1.05 #approx 60 deg

# fixed heading error that can't be steered out, rad
# TODO this needs to come from global vehicle config, as it is vehicle-specific
heading_bias: -0.0 #blue Lexus observed to be -0.011 on 6/9/22


#-----Non-PID values

# Max allowed longitudinal acceleration, m/s^2
# TODO better to get this from global vehicle config
max_accel: 2.5

# Max allowed speed to adjust the gap (this needs to be >= config speed limit), m/s
# TODO better to make this a delta above the vehicle's config max speed
speed_adjustment_cap: 12.0
